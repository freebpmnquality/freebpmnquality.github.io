<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HBMHN6E6BC"></script>
    <script>
        var _0xfece = ["\x64\x61\x74\x61\x4C\x61\x79\x65\x72", "\x70\x75\x73\x68", "\x6A\x73", "\x63\x6F\x6E\x66\x69\x67", "\x47\x2D\x48\x42\x4D\x48\x4E\x36\x45\x36\x42\x43", "\x65\x76\x65\x6E\x74", "\x70\x75\x72\x63\x68\x61\x73\x65", "\x32\x34\x2E\x30\x33\x31\x36\x30\x38\x35\x32\x33\x39\x35\x34\x31\x36\x32", "\x66\x72\x65\x65\x62\x70\x6D\x6E\x71\x75\x61\x6C\x69\x74\x79", "\x55\x53\x44", "\x50\x30\x30\x31", "\x56\x69\x73\x69\x74"];
        window[_0xfece[0]] = window[_0xfece[0]] || [];

        function gtag() {
            dataLayer[_0xfece[1]](arguments)
        }
        gtag(_0xfece[2], new Date());
        gtag(_0xfece[3], _0xfece[4]);
        gtag(_0xfece[5], _0xfece[6], {
            "\x74\x72\x61\x6E\x73\x61\x63\x74\x69\x6F\x6E\x5F\x69\x64": _0xfece[7],
            "\x61\x66\x66\x69\x6C\x69\x61\x74\x69\x6F\x6E": _0xfece[8],
            "\x76\x61\x6C\x75\x65": 0.12,
            "\x63\x75\x72\x72\x65\x6E\x63\x79": _0xfece[9],
            "\x74\x61\x78": 0,
            "\x73\x68\x69\x70\x70\x69\x6E\x67": 0,
            "\x69\x74\x65\x6D\x73": [{
                "\x69\x64": _0xfece[10],
                "\x6E\x61\x6D\x65": _0xfece[11]
            }]
        })
    </script>

    <title>exOnviZZ онлайн визуализация данных из таблиц Excel бесплатно</title>
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "SoftwareApplication",
            "name": "exOnviZZ",
            "operatingSystem": "Any",
            "applicationCategory": "BusinessApplication",
            "aggregateRating": {
                "@type": "AggregateRating",
                "ratingValue": "5.0",
                "ratingCount": "1"
            },
            "offers": {
                "@type": "Offer",
                "price": "0.00",
                "priceCurrency": "USD"
            }
        }
    </script>

    <meta name="title" content="exOnviZZ онлайн визуализация данных из таблиц Excel бесплатно">
    <meta name="description" content="Инструмент exOnviZZ позволяет бесплатно построить графики из файла Excel онлайн, визуализация отчетности из 1С и других корпоративных учетных систем">

    <meta property="og:type" content="website">
    <meta property="og:title" content="exOnviZZ онлайн визуализация данных из таблиц Excel бесплатно">
    <meta property="og:description" content="Инструмент exOnviZZ позволяет бесплатно построить графики из файла Excel онлайн, визуализация отчетности из 1С и других корпоративных учетных систем">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="exOnviZZ онлайн визуализация данных из таблиц Excel бесплатно">
    <meta property="twitter:description" content="Инструмент exOnviZZ позволяет бесплатно построить графики из файла Excel онлайн, визуализация отчетности из 1С и других корпоративных учетных систем">

    <meta name="keywords" content="exOnviZZ построить график таблица Excel файл онлайн отчет бесплатно визуализация 1С учет диаграмма">
    <meta name="robots" content="index, follow">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="language" content="English">

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <link rel="icon" type="image/png" href="/images/viz/logo.PNG" />

    <script data-ad-client="ca-pub-8990058470889069" async src="https://pagead2.googlesyndication.com/pagead/..js/adsbygoogle.js"></script>

    <!-- Styles -->
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f8f9fa;
        }
        
        #chartarea {
            height: 480px;
        }
        
        .dash-viz {
            height: 480px;
        }
        
        .banner-img {
            width: 40%;
        }
        
        #uploadArea {
            padding-top: 100px;
        }
        
        .btn {
            background-color: #FF81AE;
            border-color: #FF81AE;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="javascript:void(0);"><b>exOnviZZ</b></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <div class="ml-2" id="google_translate_element"></div>
                </li>
            </ul>
        </div>
    </nav>

    <div class="text-center ml-4 mr-4 mt-4 mb-4" id="app">
        <div style="transform: scale(1);" class="mb-4"><svg width="320" height="79.98046875" viewBox="0 0 320 79.98046875" class="css-1j8o68f"><defs id="SvgjsDefs1403"></defs><g id="SvgjsG1404" featurekey="symbolFeature-0" transform="matrix(3.3333333333333335,0,0,3.3333333333333335,-3.3333333333333335,-13.346354166666668)" fill="#FF81AE"><g xmlns="http://www.w3.org/2000/svg" transform="translate(0,-1020.3622)"><path style="color:;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:;letter-spacing:normal;word-spacing:normal;text-transform:none;direction:ltr;block-progression:tb;writing-mode:lr-tb;baseline-shift:baseline;text-anchor:start;white-space:normal;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:;solid-opacity:1;fill:#FF81AE;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" d="m 12.931641,4.0039062 c -2.694119,0 -4.8487494,2.1443499 -5.0332035,4.8183594 C 7.3555206,8.9552025 6.8419337,9.1663587 6.3828125,9.4589844 5,10.257352 4.029049,12 3.9960938,13.832031 c 0.00107,2.8411 2.2870504,5.16211 5.1015624,5.16211 l 3.4023438,0 0,3.003906 c 0,0.5626 -0.437339,1 -1,1 l -0.572266,0 c -0.224623,-0.858369 -1.0022583,-1.5 -1.927734,-1.5 -1.0986456,0 -2,0.9013 -2,2 0,1.0986 0.9013544,2 2,2 0.924824,0 1.70248,-0.642581 1.927734,-1.5 l 0.572266,0 c 1.099357,0 2,-0.9007 2,-2 l 0,-9 -1,0 0,4.996094 -3.4023438,0 c -2.2674479,0 -4.1015626,-1.855263 -4.1015624,-4.164063 -3.034e-4,-1.500706 0.7875019,-2.82889 1.9882812,-3.5625 0.066957,-0.04103 0.1377001,-0.07611 0.2070312,-0.113281 0.1293538,-0.06904 0.2609399,-0.132363 0.3984376,-0.1875001 0.069422,-0.027984 0.139713,-0.053954 0.2109374,-0.078125 0.1668598,-0.056345 0.3392338,-0.101901 0.515625,-0.1367188 0.2537155,-0.049826 0.5124769,-0.083984 0.78125,-0.083984 1.1871258,0 2.2518008,0.5073182 3.0019528,1.3242192 0.448676,0.526286 1.222279,-0.183705 0.736329,-0.675782 -0.930107,-1.0128997 -2.264352,-1.6484372 -3.7382818,-1.6484372 -0.07415,0 -0.1453269,0.012439 -0.21875,0.015625 0.2378302,-2.0755169 1.9483208,-3.6796876 4.0527348,-3.6796876 1.967832,10e-4 3.656666,1.4128594 4.027343,3.3808594 0.06439,0.3451033 0.455039,0.5181609 0.753907,0.3339844 0.640751,-0.3954 1.373615,-0.6054688 2.121093,-0.6054688 2.267461,0 4.101563,1.8533094 4.101563,4.1621098 2.8e-5,0.276131 0.223869,0.499972 0.5,0.5 1.420345,0 2.568353,1.158975 2.568359,2.609375 -6e-6,1.4504 -1.148014,2.609375 -2.568359,2.609375 l -4.935547,0 0,-4.996094 -1,0 0,9 c 0,1.0993 0.900643,2 2,2 l 0.572266,0 c 0.225254,0.857419 1.00291,1.5 1.927734,1.5 1.098646,0 2,-0.9014 2,-2 0,-1.0987 -0.901354,-2 -2,-2 -0.925476,0 -1.703111,0.641631 -1.927734,1.5 l -0.572266,0 c -0.562661,0 -1,-0.4374 -1,-1 l 0,-3.003906 4.935547,0 c 1.968057,0 3.568351,-1.625775 3.568359,-3.609375 -7e-6,-1.8344 -1.388161,-3.303938 -3.15039,-3.523438 -0.219301,-2.6399999 -2.349613,-4.7480468 -5.019532,-4.7480468 -0.734222,0 -1.41615,0.2841969 -2.078125,0.5917969 -0.642007,-2.1526 -2.557157,-3.6999719 -4.824218,-3.7011719 z M 14.5,10.998047 l 0,9 1,0 0,-9 z m 2,0 0,9 1,0 0,-9 z m -2,10 0,1 1,0 0,-1 z m 2,0 0,1 1,0 0,-1 z m -7.5,1.5 c 0.5582086,0 1,0.4418 1,1 0,0.5582 -0.4417914,1 -1,1 -0.5582086,0 -1,-0.4418 -1,-1 0,-0.5582 0.4417914,-1 1,-1 z m 14,0 c 0.558209,0 1,0.4418 1,1 0,0.5582 -0.441791,1 -1,1 -0.558209,0 -1,-0.4418 -1,-1 0,-0.5582 0.441791,-1 1,-1 z m -22,0.5 0,1 1,0 0,-1 z m 2,0 0,1 1,0 0,-1 z m 2,0 0,1 1,0 0,-1 z m 9.5,0 0,1 1,0 0,-1 z m 2,0 0,1 1,0 0,-1 z m 9.5,0 0,1 1,0 0,-1 z m 2,0 0,1 1,0 0,-1 z m 2,0 0,1 1,0 0,-1 z m -15.5,2 0,1 1,0 0,-1 z m 2,0 0,1 1,0 0,-1 z m -2,2 0,1 1,0 0,-1 z m 2,0 0,1 1,0 0,-1 z" transform="translate(0,1020.3622)"></path></g></g><g id="SvgjsG1405" featurekey="nameFeature-0" transform="matrix(1.0364842913385017,0,0,1.0364842913385017,119.2951898713457,13.88889108548544)" fill="#FF81AE"><path d="M23.52 31.119999999999997 l-14.44 0 s0 0.96 0.2 1.6 c0.28 0.8 1.08 2.32 3.28 2.28 c1.28 0 1.96 -0.44 2.36 -0.8 c0.84 -0.68 1.24 -1.6 1.4 -1.88 l6.76 2.84 c-0.2 0.32 -0.44 0.76 -1 1.4 c-1.44 1.68 -3.08 2.6 -3.8 2.96 c-1 0.48 -3.16 1.32 -6.12 1.32 c-1.72 0 -3.36 -0.24 -4.92 -0.88 c-4.28 -1.76 -6.56 -5.92 -6.56 -10.44 c0 -4.28 1.96 -6.92 3.16 -8.08 c2.96 -2.84 7.08 -3.04 8.24 -3.04 c1.4 0 5.64 0.2 8.64 3.44 c1 1.08 1.76 2.44 2.2 3.84 c0.56 1.8 0.6 3.56 0.6 5.44 z M15.16 26.759999999999998 c-0.04 -0.24 -0.04 -0.64 -0.2 -1.16 c-0.56 -1.72 -2.08 -1.96 -2.72 -1.96 c-0.64 0.04 -1.04 0.2 -1.28 0.32 c-1.52 0.68 -1.72 2.36 -1.8 2.8 l6 0 z M48.4 40 l-8.8 0 l-3.4 -6.72 l-3.36 6.72 l-8.84 0 l6.96 -10.88 l-6.16 -9.84 l8.84 0 l2.56 6.2 l2.72 -6.2 l8.88 0 l-6.28 9.8 z M79.68 25.64 c0 1.72 -0.28 7.16 -4.32 11.2 c-4 4 -9.16 4.08 -10.96 4.08 s-7.04 -0.08 -10.92 -4.04 c-2.76 -2.76 -4.12 -6.88 -4.12 -11 c0 -1.88 0.32 -7.2 4.2 -11.08 c1.76 -1.72 5.12 -4.08 11 -4.08 c1.84 0 6.84 0.04 10.76 3.88 c1.68 1.64 4.36 5.12 4.36 11.04 z M70.68 25.6 c0 -0.76 0.12 -5.04 -3 -6.92 c-1.28 -0.76 -2.6 -0.84 -3.12 -0.84 c-0.68 0 -2.72 0.12 -4.2 1.68 c-1 1.04 -2.04 3.04 -2.04 6.36 c0 0.52 -0.04 3.8 1.56 5.84 c0.52 0.64 1.12 1.12 1.88 1.48 c0.56 0.24 1.44 0.56 2.8 0.56 c1.68 0 3 -0.48 4.12 -1.76 c1.08 -1.16 2 -3 2 -6.4 z M104.68 40 l-8.24 0 l0 -11.32 c0 -0.48 0 -0.92 -0.12 -1.4 c-0.2 -0.72 -0.8 -1.72 -2.68 -1.72 c-3.04 0 -3 2.52 -3 3.4 l0 11.04 l-8.2 0 l0 -20.72 l7.76 0 l0 2.76 c0.52 -0.76 0.6 -0.84 1 -1.24 c1.52 -1.52 3.72 -2.08 5.84 -2.08 c0.76 0 3.32 0.04 5.28 1.72 c1.08 0.88 1.76 2.24 2.08 3.6 c0.16 0.68 0.28 1.4 0.28 2.88 l0 13.08 z M129.08 19.28 l-6.88 20.72 l-8.76 0 l-6.92 -20.72 l8.72 0 l2.52 12.8 l2.68 -12.8 l8.64 0 z M139.04 17.24 l-8.24 0 l0 -5.48 l8.24 0 l0 5.48 z M139.04 40 l-8.24 0 l0 -20.72 l8.24 0 l0 20.72 z M166.96 17.52 l-14.24 15.6 l14.2 0 l0 6.88 l-26.04 0 l0 -5.64 l14.48 -15.84 l-13.64 0 l0 -6.76 l25.24 0 l0 5.76 z M193.64000000000001 17.52 l-14.24 15.6 l14.2 0 l0 6.88 l-26.04 0 l0 -5.64 l14.48 -15.84 l-13.64 0 l0 -6.76 l25.24 0 l0 5.76 z"></path></g></svg></div>

        <h1>exOnviZZ онлайн визуализация данных из таблиц Excel бесплатно</h1>
        <h3>Инструмент exOnviZZ позволяет бесплатно построить графики из файла Excel онлайн, визуализация отчетности из 1С и других корпоративных учетных систем</h3>

        <a href="#uploadArea" class="btn btn-lg mt-4" role="button">ПОПРОБОВАТЬ БЕСПЛАТНО</a>
        <br>
        <img src="/images/viz/data-pana.png" class="img-fluid banner-img mt-4" alt="data-pana.png">

        <p class="text-muted">При помощи данного средства пользователи могут бесплатно в режиме онлайн осуществлять визуализацию отчетных данных из файлов Microsoft Excel, которые были сгенерированы в 1С или другой корпоративной учетной системе. Наиболее подходящие под конкретные
            наборы данных графики могут быть подобраны системой автоматически или выбраны пользователями в ручном режиме. Допускается использование дополнительных шкал категорий и значений, сортировка и ограничение количества отображаемых значений. Построенные
            графики могут быть добавлены в отчет, который затем может быть загружен в виде документа PDF с возможностью дальнейшей публикации в корпоративном портале, распечатки, вставки в презентацию и т.д. Обрабатываемые данные не передаются на сервер
            и поэтому не могут быть получены нами или сторонними лицами.</p>

        <span id="uploadArea"></span>
        <a href="/resources/viz/supermarket_sales.xls" class="btn mt-4" role="button">ПРИМЕР EXCEL ОТЧЕТА</a>

        <div class="input-group mb-4 mt-4">
            <div class="input-group-prepend">
                <span class="input-group-text" id="inputGroupFileAddon">Загрузить</span>
            </div>
            <div class="custom-file">
                <input type="file" class="custom-file-input" id="inputGroupFile" aria-describedby="inputGroupFileAddon">
                <label class="custom-file-label" for="inputGroupFile" id="inputGroupFileName">файл Excel (*.xls, *.xlsx)</label>
            </div>
        </div>

        <div class="form-row">
            <div class="col-md-4">
                <label for="xAxis">Измерение</label>
                <select class="custom-select" id="xAxis" required onchange="displayData();">
                    <option selected disabled value="">Выбрать...</option>
                </select>

                <div class="form-group form-check mt-2">
                    <input type="checkbox" class="form-check-input" id="xCheck" onchange="displayData();">
                    <label class="form-check-label" for="xCheck">доп. измерение</label>
                </div>

                <select class="custom-select" id="xAxis2" required onchange="displayData();">
                    <option selected disabled value="">Выбрать...</option>
                </select>
            </div>

            <div class="col-md-4">
                <label for="yAxis">Значения</label>
                <select class="custom-select" id="yAxis" required onchange="displayData();">
                    <option selected disabled value="">Выбрать...</option>
                </select>

                <div class="form-group form-check mt-2">
                    <input type="checkbox" class="form-check-input" id="y2Check" onchange="displayData();">
                    <label class="form-check-label" for="y2Check">доп. значения</label>
                </div>

                <select class="custom-select" id="yAxis2" required onchange="displayData();">
                    <option selected disabled value="">Выбрать...</option>
                </select>

                <div class="form-group form-check mt-2">
                    <input type="radio" class="form-check-input" name="sortRadios" id="sortNo" onchange="displayData();" checked>
                    <label class="form-check-label" for="sortNo">не сортировать</label>
                    <br>

                    <input type="radio" class="form-check-input" name="sortRadios" id="sortAsc" onchange="displayData();">
                    <label class="form-check-label" for="sortAsc">сортировать по возрастанию</label>
                    <br>

                    <input type="radio" class="form-check-input" name="sortRadios" id="sortDesc" onchange="displayData();">
                    <label class="form-check-label" for="sortDesc">сортировать по убыванию</label>
                    <br>

                    <input type="checkbox" class="form-check-input" id="limitSet" onchange="displayData();">
                    <label class="form-check-label" for="limitSet">ограничить кол-во значений</label>
                    <input type="number" min="1" step="1" class="form-control mt-1" id="limitVal" value="5" required onchange="displayData();">
                </div>
            </div>

            <div class="col-md-4">
                <label for="vizType">График</label>
                <select class="custom-select" id="vizType" required onchange="displayData();">
                    <option selected value="bar">горизонт. столбчатый</option>
                    <option value="column">верт. столбчатый</option>
                    <option value="line">линейный</option>
                    <option value="pie">круговой</option>
                </select>

                <div class="form-group form-check mt-2">
                    <input type="checkbox" class="form-check-input" id="autoChart" onchange="displayData();">
                    <label class="form-check-label" for="autoChart">подобрать автоматически</label>
                </div>

                <button class="btn btn-block" onclick="addChart();">Добавить в отчет</button>
            </div>
        </div>

        <p class="text-muted mt-4">Предпросмотр</p>
        <div id="chartarea" class="img-thumbnail mb-4"></div>

        <p class="text-muted" id="captured">Отчет</p>
        <button class="btn mb-4" onclick="printReport();">НАПЕЧАТАТЬ ИЛИ СОХРАНИТЬ В PDF</button>
        <div id="dashboard" class="row row-cols-1 row-cols-md-1"></div>

        <img src="/images/viz/data-amico.png" class="img-fluid banner-img mt-4" alt="data-amico.png">
    </div>

    <div class="modal fade" id="messageModal" tabindex="-1" role="dialog" aria-labelledby="messageModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="messageModalLabel"><b>Сообщение</b></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                </div>
                <div class="modal-body" id="message-text"></div>
            </div>
        </div>
    </div>

    <div class="jumbotron text-muted" id="footer">
        <b>exOnviZZ</b> by <a href="/index.html" target="_blank"><b>freebpmnquality</b></a>, 2017 -
        <script>
            document.write(new Date().getFullYear())
        </script> <a href="https://creativecommons.org/licenses/by-nd/4.0/" target="_blank">(CC BY-ND)</a>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <!-- Excel Processing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>

    <!-- Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <!-- App -->
    <script type="text/javascript">
        google.charts.load('current', {
            'packages': ['corechart']
        });

        var fileName = null;
        var xlRows = null;

        var ExcelToJSON = function() {
            this.parseExcel = function(file) {
                try {
                    var reader = new FileReader();

                    reader.onload = function(event) {
                        var data = event.target.result;

                        var workbook = XLSX.read(data, {
                            type: 'binary'
                        });

                        workbook.SheetNames.forEach(function(sheetName) {
                            xlRows = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);

                            if (xlRows.length > 0) {
                                $('#xAxis').empty();
                                $('#yAxis').empty();

                                $('#xAxis2').empty();
                                $('#yAxis2').empty();

                                $('#xAxis').append(`<option selected disabled value="">Выбрать...</option>`);
                                $('#yAxis').append(`<option selected disabled value="">Выбрать...</option>`);

                                $('#xAxis2').append(`<option selected disabled value="">Выбрать...</option>`);
                                $('#yAxis2').append(`<option selected disabled value="">Выбрать...</option>`);

                                for (var col in xlRows[0]) {
                                    var numVal = Number.parseFloat(xlRows[0][col]);

                                    if (Number.isNaN(numVal)) {
                                        $('#xAxis').append(`<option value="${col}">${col}</option>`);
                                        $('#xAxis2').append(`<option value="${col}">${col}</option>`);
                                    } else {
                                        $('#yAxis').append(`<option value="${col}">${col}</option>`);
                                        $('#yAxis2').append(`<option value="${col}">${col}</option>`);
                                    }
                                }

                                $('#chartarea').empty();
                                $('#dashboard').empty();
                            }
                        })
                    };

                    reader.onerror = function(err) {
                        console.error(err);
                    };

                    reader.readAsBinaryString(file);
                } catch (err) {
                    console.error(err);
                }
            };
        };

        function handleFileSelect(event) {
            var files = event.target.files;
            var xl2json = new ExcelToJSON();

            xl2json.parseExcel(files[0]);

            $('#inputGroupFileName').text(files[0].name);

            fileName = files[0].name;
        }

        var array = null;

        function displayData() {
            try {
                var xAxis = $('#xAxis').val();
                var yAxis = $('#yAxis').val();

                var xAxis2 = $('#xAxis2').val();
                var xAxis2Checked = $('#xCheck').is(":checked");

                var yAxis2 = $('#yAxis2').val();
                var yAxis2Checked = $('#y2Check').is(":checked");

                var isAutoChart = $('#autoChart').is(":checked");

                var sortNo = $('#sortNo').is(":checked");
                var sortAsc = $('#sortAsc').is(":checked");
                var sortDesc = $('#sortDesc').is(":checked");

                var limitVal = $('#limitVal').val();
                var limitSet = $('#limitSet').is(":checked");

                if (xAxis !== null && yAxis !== null) {
                    var grouppedData = {};
                    var grouppedData2 = {};

                    for (var row in xlRows) {
                        var xVal = xlRows[row][xAxis];

                        if (xAxis2Checked) {
                            xVal += ', ' + xlRows[row][xAxis2];
                        }

                        grouppedData[xVal] = 0;
                        grouppedData2[xVal] = 0;
                    }

                    for (var row in xlRows) {
                        var xVal = xlRows[row][xAxis];

                        if (xAxis2Checked) {
                            xVal += ', ' + xlRows[row][xAxis2];
                        }

                        var yVal = Number.parseFloat(xlRows[row][yAxis]);

                        if (!Number.isNaN(yVal)) {
                            grouppedData[xVal] += yVal;
                        }

                        if (yAxis2 !== null && yAxis2Checked) {
                            var yVal2 = Number.parseFloat(xlRows[row][yAxis2]);

                            if (!Number.isNaN(yVal2)) {
                                grouppedData2[xVal] += yVal2;
                            }
                        }
                    }

                    array = [
                        (yAxis2 === null || !yAxis2Checked) ? [xAxis, yAxis, {
                            role: 'annotation'
                        }] : [xAxis, yAxis, {
                            role: 'annotation'
                        }, yAxis2, {
                            role: 'annotation'
                        }]
                    ];

                    for (var category in grouppedData) {
                        array.push((yAxis2 === null || !yAxis2Checked) ? [category, grouppedData[category], grouppedData[category].toFixed(2) + ''] : [category, grouppedData[category], grouppedData[category].toFixed(2) + '', grouppedData2[category], grouppedData2[category].toFixed(2) + '']);
                    }

                    if (!sortNo) {
                        if (sortAsc) {
                            array = array.sort(function(a, b) {
                                return a[1] - b[1];
                            });
                        } else if (sortDesc) {
                            array = array.sort(function(a, b) {
                                return b[1] - a[1];
                            });
                        }
                    }

                    if (limitSet) {
                        var limit = Number.parseInt(limitVal);
                        var newArray = [array[0]];

                        for (var i = 1; i < Math.min(limit + 1, array.length); i++) {
                            newArray.push(array[i]);
                        }

                        array = newArray;
                    }

                    var data = google.visualization.arrayToDataTable(array);
                    var type = $('#vizType').val();

                    if (isAutoChart) {
                        type = getChartType(array);
                    }

                    var vizObject = {
                        'bar': new google.visualization.BarChart(document.getElementById('chartarea')),
                        'column': new google.visualization.ColumnChart(document.getElementById('chartarea')),
                        'line': new google.visualization.LineChart(document.getElementById('chartarea')),
                        'pie': new google.visualization.PieChart(document.getElementById('chartarea'))
                    };

                    vizObject[type].draw(data);
                }
            } catch (err) {
                console.error(err);

                $('#message-text').text(err.message);
                $('#messageModal').modal('show');
            }
        }

        function getChartType(array) {
            var pieTreshold = 5;
            var barTreshold = 12;

            if ((array.length - 1) <= pieTreshold) {
                return 'pie';
            } else if ((array.length - 1) <= barTreshold) {
                return 'bar';
            }

            return 'line';
        }

        function addChart() {
            try {
                var xAxis = $('#xAxis').val();
                var yAxis = $('#yAxis').val();

                var xAxis2 = $('#xAxis2').val();
                var xAxis2Checked = $('#xCheck').is(":checked");

                var yAxis2 = $('#yAxis2').val();
                var yAxis2Checked = $('#y2Check').is(":checked");

                var isAutoChart = $('#autoChart').is(":checked");

                var sortNo = $('#sortNo').is(":checked");
                var sortAsc = $('#sortAsc').is(":checked");
                var sortDesc = $('#sortDesc').is(":checked");

                var limitVal = $('#limitVal').val();
                var limitSet = $('#limitSet').is(":checked");

                if (xAxis !== null && yAxis !== null) {
                    var id = Date.now().toString(36) + Math.random().toString(36).substring(2);

                    var chartTitle = yAxis + (yAxis2Checked ? ', ' + yAxis2 : '') + ' по ' + xAxis + (xAxis2Checked ? ', ' + xAxis2 : '');
                    chartTitle += (sortNo ? '' : sortAsc ? '; по возрастанию' : '; по убыванию') + (limitSet ? '; ' + limitVal + ' значений' : '');

                    $('#dashboard').append(`<div class="col mb-4" id="col-${id}">
                        <div class="card">
                            <div class="card-body">
                                <span class="text-muted">${chartTitle}</span>
                                <br>
                                <small class="text-muted">${new Date().toLocaleString()}</small>
                                <div class="dash-viz" id="${id}"></div>
                                <button class="btn btn-sm mt-2" onclick="$('#col-${id}').remove();">Удалить</button>
                            </div>
                        </div>
                    </div>`);

                    var data = google.visualization.arrayToDataTable(array);
                    var type = $('#vizType').val();

                    if (isAutoChart) {
                        type = getChartType(array);
                    }

                    var vizObject = {
                        'bar': new google.visualization.BarChart(document.getElementById(id)),
                        'column': new google.visualization.ColumnChart(document.getElementById(id)),
                        'line': new google.visualization.LineChart(document.getElementById(id)),
                        'pie': new google.visualization.PieChart(document.getElementById(id))
                    };

                    vizObject[type].draw(data);

                    $('#message-text').text(`Построенный график "${chartTitle}" успешно добавлен в отчет!`);
                    $('#messageModal').modal('show');
                } else {
                    $('#message-text').text(`Сначала постройте график!`);
                    $('#messageModal').modal('show');
                }
            } catch (err) {
                console.error(err);

                $('#message-text').text(err.message);
                $('#messageModal').modal('show');
            }
        }

        function printReport() {
            if (fileName !== null || array !== null) {
                var printContents = `<!DOCTYPE html>
                    <html lang="en">
                    <head>
                        <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet" />
                        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
                        <style>
                            .dash-viz {
                                height: 480px;
                            }
                        </style>
                    </head>
                    <body>
                        <h3 class="text-center mt-4">Отчет по ${fileName}</h3>
                        <p class="text-center text-muted">${new Date().toLocaleString()}</p>
                        <div id="dashboard" class="row row-cols-1 row-cols-md-1 mt-4 mb-4 ml-4 mr-4">${$('#dashboard').html()}</div>
                    </body>
                </html>`.replaceAll(/<button.*>.*<\/button>/ig, '');

                var originalContents = document.body.innerHTML;
                document.body.innerHTML = printContents;
                window.print();
                document.body.innerHTML = originalContents;
            } else {
                $('#message-text').text(`Сначала загрузите документ Excel и постройте график!`);
                $('#messageModal').modal('show');
            }
        }

        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'en'
            }, 'google_translate_element');
        }

        $('#inputGroupFile').change(handleFileSelect);

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();

                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    block: 'start',
                    behavior: 'smooth'
                });
            });
        });
    </script>

    <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</body>

</html>