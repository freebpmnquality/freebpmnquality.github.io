<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HBMHN6E6BC"></script>
    <script>
        var _0xfece = ["\x64\x61\x74\x61\x4C\x61\x79\x65\x72", "\x70\x75\x73\x68", "\x6A\x73", "\x63\x6F\x6E\x66\x69\x67", "\x47\x2D\x48\x42\x4D\x48\x4E\x36\x45\x36\x42\x43", "\x65\x76\x65\x6E\x74", "\x70\x75\x72\x63\x68\x61\x73\x65", "\x32\x34\x2E\x30\x33\x31\x36\x30\x38\x35\x32\x33\x39\x35\x34\x31\x36\x32", "\x66\x72\x65\x65\x62\x70\x6D\x6E\x71\x75\x61\x6C\x69\x74\x79", "\x55\x53\x44", "\x50\x30\x30\x31", "\x56\x69\x73\x69\x74"];
        window[_0xfece[0]] = window[_0xfece[0]] || [];

        function gtag() {
            dataLayer[_0xfece[1]](arguments)
        }
        gtag(_0xfece[2], new Date());
        gtag(_0xfece[3], _0xfece[4]);
        gtag(_0xfece[5], _0xfece[6], {
            "\x74\x72\x61\x6E\x73\x61\x63\x74\x69\x6F\x6E\x5F\x69\x64": _0xfece[7],
            "\x61\x66\x66\x69\x6C\x69\x61\x74\x69\x6F\x6E": _0xfece[8],
            "\x76\x61\x6C\x75\x65": 0.12,
            "\x63\x75\x72\x72\x65\x6E\x63\x79": _0xfece[9],
            "\x74\x61\x78": 0,
            "\x73\x68\x69\x70\x70\x69\x6E\x67": 0,
            "\x69\x74\x65\x6D\x73": [{
                "\x69\x64": _0xfece[10],
                "\x6E\x61\x6D\x65": _0xfece[11]
            }]
        })
    </script>

    <title>{{TITLE}}</title>
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "SoftwareApplication",
            "name": "{{NAME}}",
            "operatingSystem": "Any",
            "applicationCategory": "BusinessApplication",
            "offers": {
                "@type": "Offer",
                "price": "0.00",
                "priceCurrency": "USD"
            }
        }
    </script>

    <meta name="title" content="{{TITLE}}">
    <meta name="description" content="{{DESCRIPTION}}">

    <meta property="og:type" content="website">
    <meta property="og:title" content="{{TITLE}}">
    <meta property="og:description" content="{{DESCRIPTION}}">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="{{TITLE}}">
    <meta property="twitter:description" content="{{DESCRIPTION}}">

    <meta name="keywords" content="scor supply chain management scm plan dropshipping calculator business process order shipping returning supplier customer">
    <meta name="robots" content="index, follow">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="language" content="English">

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css?family=Kanit" rel="stylesheet" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <link rel="icon" type="image/png" href="/images/scm/logo.PNG" />

    <script data-ad-client="ca-pub-8990058470889069" async src="https://pagead2.googlesyndication.com/pagead/..js/adsbygoogle.js"></script>

    <!-- Styles -->
    <style>
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #f8f9fa;
        }
        
        #chartarea {
            height: 480px;
        }
    </style>
</head>

<body>
    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="javascript:void(0);"><b>{{NAME}}</b></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <div class="ml-2" id="google_translate_element"></div>
                </li>
            </ul>
        </div>
    </nav>

    <div class="text-center ml-4 mr-4 mt-4 mb-4" id="app">
        <h1>{{TITLE}}</h1>
        <h3>{{DESCRIPTION}}</h3>

        <p class="text-muted">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure
            dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>

        <div class="input-group mb-4">
            <div class="input-group-prepend">
                <span class="input-group-text" id="inputGroupFileAddon">Upload</span>
            </div>
            <div class="custom-file">
                <input type="file" class="custom-file-input" id="inputGroupFile" aria-describedby="inputGroupFileAddon">
                <label class="custom-file-label" for="inputGroupFile" id="inputGroupFileName">Choose Excel spreadsheet file</label>
            </div>
        </div>

        <div class="form-row">
            <div class="col-md-4 mb-3">
                <label for="xAxis">Category</label>
                <select class="custom-select" id="xAxis" required onchange="displayData();">
                    <option selected disabled value="">Choose...</option>
                </select>

                <div class="form-group form-check mt-2">
                    <input type="checkbox" class="form-check-input" id="xCheck" onchange="displayData();">
                    <label class="form-check-label" for="xCheck">Use secondary category</label>
                </div>

                <select class="custom-select" id="xAxis2" required onchange="displayData();">
                    <option selected disabled value="">Choose...</option>
                </select>
            </div>

            <div class="col-md-4 mb-3">
                <label for="yAxis">Value</label>
                <select class="custom-select" id="yAxis" required onchange="displayData();">
                    <option selected disabled value="">Choose...</option>
                </select>

                <div class="form-group form-check mt-2">
                    <input type="checkbox" class="form-check-input" id="y2Check" onchange="displayData();">
                    <label class="form-check-label" for="y2Check">Use secondary value</label>
                </div>

                <select class="custom-select" id="yAxis2" required onchange="displayData();">
                    <option selected disabled value="">Choose...</option>
                </select>
            </div>

            <div class="col-md-4 mb-3">
                <label for="vizType">Chart</label>
                <select class="custom-select" id="vizType" required onchange="displayData();">
                    <option selected value="auto">Auto</option>
                    <option value="bar">Bar</option>
                    <option value="column">Column</option>
                    <option value="line">Line</option>
                    <option value="pie">Pie</option>
                </select>
            </div>
        </div>

        <div id="chartarea" class="img-thumbnail mt-1"></div>
    </div>

    <div class="jumbotron text-muted" id="footer">
        <b>{{NAME}}</b> by <a href="/index.html" target="_blank"><b>freebpmnquality</b></a>, 2017 -
        <script>
            document.write(new Date().getFullYear())
        </script> <a href="https://creativecommons.org/licenses/by-nd/4.0/" target="_blank">(CC BY-ND)</a>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <!-- Excel Processing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>

    <!-- Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <!-- App -->
    <script type="text/javascript">
        google.charts.load('current', {
            'packages': ['corechart']
        });

        var xlRows = null;

        var ExcelToJSON = function() {
            this.parseExcel = function(file) {
                try {
                    var reader = new FileReader();

                    reader.onload = function(event) {
                        var data = event.target.result;

                        var workbook = XLSX.read(data, {
                            type: 'binary'
                        });

                        workbook.SheetNames.forEach(function(sheetName) {
                            xlRows = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);

                            if (xlRows.length > 0) {
                                $('#xAxis').empty();
                                $('#yAxis').empty();

                                $('#xAxis2').empty();
                                $('#yAxis2').empty();

                                $('#xAxis').append(`<option selected disabled value="">Choose...</option>`);
                                $('#yAxis').append(`<option selected disabled value="">Choose...</option>`);

                                $('#xAxis2').append(`<option selected disabled value="">Choose...</option>`);
                                $('#yAxis2').append(`<option selected disabled value="">Choose...</option>`);

                                for (var col in xlRows[0]) {
                                    var numVal = Number.parseFloat(xlRows[0][col]);

                                    if (Number.isNaN(numVal)) {
                                        $('#xAxis').append(`<option value="${col}">${col}</option>`);
                                        $('#xAxis2').append(`<option value="${col}">${col}</option>`);
                                    } else {
                                        $('#yAxis').append(`<option value="${col}">${col}</option>`);
                                        $('#yAxis2').append(`<option value="${col}">${col}</option>`);
                                    }
                                }
                            }
                        })
                    };

                    reader.onerror = function(err) {
                        console.error(err);
                    };

                    reader.readAsBinaryString(file);
                } catch (err) {
                    console.error(err);
                }
            };
        };

        function handleFileSelect(event) {
            var files = event.target.files;
            var xl2json = new ExcelToJSON();

            xl2json.parseExcel(files[0]);

            $('#inputGroupFileName').text(files[0].name);
        }

        function displayData() {
            try {
                var xAxis = $('#xAxis').val();
                var yAxis = $('#yAxis').val();

                var yAxis2 = $('#yAxis2').val();
                var yAxis2Checked = $('#y2Check').is(":checked")

                if (xAxis !== null && yAxis !== null) {
                    var grouppedData = {};
                    var grouppedData2 = {};

                    for (var row in xlRows) {
                        var xVal = xlRows[row][xAxis];

                        grouppedData[xVal] = 0;
                        grouppedData2[xVal] = 0;
                    }

                    for (var row in xlRows) {
                        var xVal = xlRows[row][xAxis];
                        var yVal = Number.parseFloat(xlRows[row][yAxis]);

                        if (!Number.isNaN(yVal)) {
                            grouppedData[xVal] += yVal;
                        }

                        if (yAxis2 !== null && yAxis2Checked) {
                            var yVal2 = Number.parseFloat(xlRows[row][yAxis2]);

                            if (!Number.isNaN(yVal2)) {
                                grouppedData2[xVal] += yVal2;
                            }
                        }
                    }

                    var array = [
                        (yAxis2 === null || !yAxis2Checked) ? [xAxis, yAxis] : [xAxis, yAxis, yAxis2]
                    ];

                    for (var category in grouppedData) {
                        array.push((yAxis2 === null || !yAxis2Checked) ? [category, grouppedData[category]] : [category, grouppedData[category], grouppedData2[category]]);
                    }

                    var data = google.visualization.arrayToDataTable(array);
                    var type = $('#vizType').val();

                    if (type === 'auto') {
                        if ((array.length - 1) <= 5) {
                            type = 'pie';
                        } else if ((array.length - 1) <= 12) {
                            type = 'bar';
                        } else {
                            type = 'line';
                        }
                    }

                    var vizObject = {
                        'bar': new google.visualization.BarChart(document.getElementById('chartarea')),
                        'column': new google.visualization.ColumnChart(document.getElementById('chartarea')),
                        'line': new google.visualization.LineChart(document.getElementById('chartarea')),
                        'pie': new google.visualization.PieChart(document.getElementById('chartarea'))
                    };

                    vizObject[type].draw(data);
                }
            } catch (err) {
                console.error(err);
            }
        }

        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'en'
            }, 'google_translate_element');
        }

        $('#inputGroupFile').change(handleFileSelect);
    </script>

    <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</body>

</html>